{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/logan/Projects/in-death-tournament/client/src/app/tournaments/%5Bid%5D/edit/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport axios from \"axios\";\r\n\r\ninterface Tournament {\r\n    _id: string;\r\n    name: string;\r\n    description: string;\r\n    startDate: string;\r\n    endDate: string;\r\n    type: string;\r\n    rules: string;\r\n    createdBy: { _id: string; username: string };\r\n}\r\n\r\nexport default function EditTournament() {\r\n    const { id } = useParams();\r\n    const router = useRouter();\r\n    const [tournament, setTournament] = useState<Tournament | null>(null);\r\n    const [user, setUser] = useState<{ _id: string; username: string; role: string } | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(\"\");\r\n    const [formData, setFormData] = useState({\r\n        name: \"\",\r\n        description: \"\",\r\n        startDate: \"\",\r\n        endDate: \"\",\r\n        type: \"\",\r\n        rules: \"\"\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (!id) return;\r\n\r\n        // ✅ Fetch Tournament\r\n        axios.get(`http://localhost:5000/api/tournaments/${id}`)\r\n            .then(res => {\r\n                setTournament(res.data);\r\n                setFormData({\r\n                    name: res.data.name,\r\n                    description: res.data.description,\r\n                    startDate: res.data.startDate.split(\"T\")[0],\r\n                    endDate: res.data.endDate.split(\"T\")[0],\r\n                    type: res.data.type,\r\n                    rules: res.data.rules\r\n                });\r\n            })\r\n            .catch(() => setError(\"Tournament not found\"))\r\n            .finally(() => setLoading(false));\r\n\r\n        // ✅ Fetch User\r\n        axios.get(\"http://localhost:5000/auth/user\", { withCredentials: true })\r\n            .then(res => setUser(res.data))\r\n            .catch(() => setUser(null));\r\n    }, [id]);\r\n\r\n    const handleChange = (e: any) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n    };\r\n\r\n    const handleSubmit = async (e: any) => {\r\n        e.preventDefault();\r\n        try {\r\n            await axios.put(`http://localhost:5000/api/tournaments/${id}`, formData, { withCredentials: true });\r\n            alert(\"Tournament updated successfully!\");\r\n            router.push(`/tournaments/${id}`);\r\n        } catch (err) {\r\n            alert(\"Failed to update tournament.\");\r\n        }\r\n    };\r\n\r\n    if (loading) return <p>Loading tournament...</p>;\r\n    if (error) return <p className=\"text-red-500\">{error}</p>;\r\n    if (!tournament) return null;\r\n\r\n    // ✅ Restrict Editing to Admins or the Tournament Creator\r\n    if (!user || !tournament?.createdBy || (user._id !== tournament.createdBy._id && user.role !== \"admin\")) {\r\n        return <p className=\"text-red-500\">Access denied. You cannot edit this tournament.</p>;\r\n    }\r\n\r\n    return (\r\n        <main className=\"flex flex-col items-center p-10\">\r\n            <h1 className=\"text-3xl font-bold\">Edit Tournament</h1>\r\n            <form className=\"w-full max-w-lg\" onSubmit={handleSubmit}>\r\n                <label className=\"block\">Name:</label>\r\n                <input type=\"text\" name=\"name\" value={formData.name} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <label className=\"block mt-2\">Description:</label>\r\n                <textarea name=\"description\" value={formData.description} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <label className=\"block mt-2\">Start Date:</label>\r\n                <input type=\"date\" name=\"startDate\" value={formData.startDate} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <label className=\"block mt-2\">End Date:</label>\r\n                <input type=\"date\" name=\"endDate\" value={formData.endDate} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <label className=\"block mt-2\">Type:</label>\r\n                <input type=\"text\" name=\"type\" value={formData.type} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <label className=\"block mt-2\">Rules:</label>\r\n                <textarea name=\"rules\" value={formData.rules} onChange={handleChange} className=\"border p-2 w-full\" required />\r\n\r\n                <button type=\"submit\" className=\"mt-4 px-4 py-2 bg-blue-500 text-white rounded\">\r\n                    Update Tournament\r\n                </button>\r\n            </form>\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}